<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Login com Google para Planilha</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
  <h2>Login com Google</h2>

  <!-- Configuração do Google One Tap -->
  <div id="g_id_onload"
       data-client_id="1028119812736-rp5m9cnbplccdqbcsltd7gvt140dtaod.apps.googleusercontent.com"
       data-callback="handleCredentialResponse">
  </div>
  <div class="g_id_signin" data-type="standard"></div>

  <script>
    function handleCredentialResponse(response) {
      // Envia o token para o backend
      fetch("https://script.google.com/macros/s/AKfycbwQSdpfdcckK_CifR1OLQ2SuFWN45EbO9x5y2ib9DkIzJcc0IB-LuImHqKH4mvekw/exec", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ token: response.credential })
      })
      .then(r => r.json())
      .then(data => {
        if (data.success) {
          // Redireciona para a planilha
          window.location.href = data.url;
        } else {
          alert(data.message || "Falha no login");
        }
      })
      .catch(err => {
        alert("Erro de conexão: " + err);
      });
    }
  </script>
</body>
</html>
